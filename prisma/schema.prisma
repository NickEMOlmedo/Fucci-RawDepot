generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Calidad {
  bueno
  regular
  malo
}

model Administrador {
  id         Int       @id @default(autoincrement())
  nombre     String    @db.VarChar(30)
  apellido   String    @db.VarChar(30)
  dni        Int       @unique
  email      String    @db.VarChar(255)
  contrasena String    @db.VarChar(30)
  ingreso    Ingreso[]
  retiro     Retiro[]
}

model Empleado {
  id         Int      @id @default(autoincrement())
  nombre     String   @db.VarChar(30)
  apellido   String   @db.VarChar(30)
  dni        Int      @unique
  contrasena String   @db.VarChar(255)
  area       String   @db.VarChar(30)
  rol        String   @db.VarChar(30)
  retiro     Retiro[]
}

model Producto {
  id            Int             @id @default(autoincrement())
  nombre        String          @db.VarChar(30)
  stock         BigInt
  marca         String          @db.VarChar(30)
  fabricante    String          @db.VarChar(30)
  presentacion  String          @db.VarChar(30)
  estadoCalidad Calidad
  loteProducto  LoteProducto[]
  detalleRetiro DetalleRetiro[]
}

model Ingreso {
  id               Int           @id @default(autoincrement())
  tipoProducto     String        @db.VarChar(30)
  codigoRemito     String        @db.VarChar(30)
  empresaEntrega   String        @db.VarChar(30)
  fechaIngreso     DateTime
  cantidad         Int
  estado           Calidad
  administrador    Administrador @relation(fields: [administradorDni], references: [dni])
  administradorDni Int
}

model LoteProducto {
  id               BigInt   @id @default(autoincrement())
  lote             String   @db.VarChar(50)
  fechaVencimiento DateTime
  cantidad         BigInt
  producto         Producto @relation(fields: [productoId], references: [id])
  productoId       Int
}

model Retiro {
  id               Int             @id @default(autoincrement())
  fechaRetiro      DateTime
  empleado         Empleado        @relation(fields: [empleadoDni], references: [dni])
  empleadoDni      Int
  detalleRetiro    DetalleRetiro[]
  administrador    Administrador?  @relation(fields: [administradorDni], references: [dni])
  administradorDni Int?
}

model DetalleRetiro {
  id            BigInt   @id @default(autoincrement())
  cantidad      BigInt
  estado        Calidad
  observaciones String   @db.VarChar(100)
  retiro        Retiro   @relation(fields: [retiroId], references: [id])
  retiroId      Int
  producto      Producto @relation(fields: [productoId], references: [id])
  productoId    Int
}
